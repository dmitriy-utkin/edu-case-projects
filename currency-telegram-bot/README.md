# CRYPTO CURRENCY NOTIFICATOR BOT
___

## Как запустить

1) Необходимо клонировать репозиторий на локальную машину
2) Запустить приложение Docker, открыть проект в IDEA
3) Далее зайти в файл `"docker-compose.yml"`, поменять следующие настройки для инициализации вашего бота:
      ```yaml
   environment:
      BOT_NAME: default -> поставить актуальное название вашего телеграм-бота
      BOT_TOKEN: default -> поставить актуальный токен для доступа к вашему телеграм-боту
   ```
    #### *БУДЬТЕ ВНИМАТЕЛЬНЫ! НАСТРОЙКИ ВЫШЕ - ПЕРСОНАЛЬНЫЕ ДАННЫЕ, НЕОБХОДИМО ДЕРЖАТЬ ИХ В СЕКРЕТЕ*
4) Дополнительно вы можете поменять настройки частоты уведомления пользователей:
    ```yaml
   environment:
      NOTIFICATION_DELAY: 10
      NOTIFICATION_DELAY_UNIT: MINUTES
   ```
5) Далее перейти в консоль вашей среды разработки, перейти в папку docker и ввести команду
   1) `sh crypto-bot-launcher.sh` для MacOS, Linux
   2) `cmd crypto-bot-launcher.cmd` для Win
6) Далее можете переходить в бота в Telegram и проверить его функционал

## О проекте

### Хранение данных в проекте:
1) Для хранения информации о подписках пользователей используется база данных PostgreSQL
2) Для хранения данных о последнем уведомления пользователя используется Redis

### Функционал бота:

#### Для информации:
1) Одновременно у пользователя может быть оформлено только по одной подписке на продажу и по одной подписке на покупку
2) Пользователь может задавать цену с учетом разделителя (как ",", так и ".")

#### Доступные команды:
1) /help - получить список доступных команд
2) /get_price - получить актуальную цену на BTC в USD
3) /subscribe <price> <type> - оформить подписку на нужную цену и тип уведомления (buy/sell), пример:
   1) `/subscribe 43000.123 buy` - так можно подписать на уведомления о покупке, когда цена на BTC будет ниже 43000.123 USD
   2) `/subscribe 45000.123 sell` - так можно подписать на уведомления о продаже, когда цена на BTC будет выше 45000.123 USD
4) /get_subscription - показать оформленные подписки на уведомления
5) /unsubscribe <type> - отменить выбранный тип подписок (all/buy/sell), пример:
   1) `/unsubscribe all` - отменить все имеющиеся подписки
   2) `/unsubscribe buy` - отменить подписку на цену для покупки
   3) `/unsubscribe sell` - отменить подписку на цену для продажи

#### Как работают уведомления пользователя:
1) В приложении настроена автоматическая проверка актуального курса на BTC (каждые 2 минуты)
2) Метод, которые запускается каждые две минуты (в классе `.../cryptobot/bot/notification/BotNotification.java`), обращается в сервис сбора списка адресатов и сообщений для них:
3) Путем проверки, походит ли сохраненная пользователями подписка под текущую цену, производится проверка на возможность отправки нового уведомления (если прошло заданное время на частоту уведомления каждого пользователя):
   1) Как было сказано ранее, вы можете настроить частотность уведомления пользователей, для этого необходимо выбрать необходимые параметры в docker-compose.yml:
      ```yaml
      environment:
         NOTIFICATION_DELAY: 10
         NOTIFICATION_DELAY_UNIT: MINUTES
      ```

#### И самое приятное:

_Когда вы запустите бота командой "/start", он обязательно поздоровается с вами, обратившись по имени :wave:_